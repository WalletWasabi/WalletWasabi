<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:c="clr-namespace:WalletWasabi.Fluent.Controls"
             xmlns:locator="using:WalletWasabi.Fluent"
             xmlns:tiles="using:WalletWasabi.Fluent.ViewModels.Wallets.Home.Tiles"
             xmlns:wallets="clr-namespace:WalletWasabi.Fluent.ViewModels.Wallets"
             xmlns:history="using:WalletWasabi.Fluent.Views.Wallets.Home.History"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="850"
             x:DataType="wallets:WalletViewModel"
             x:CompileBindings="True"
             ClipToBounds="False"
             x:Class="WalletWasabi.Fluent.Views.Wallets.WalletView">
  <c:ContentArea ScrollViewer.VerticalScrollBarVisibility="Disabled" ClipToBounds="False" HeaderBackground="{DynamicResource HeaderRegionColor}">
    <c:ContentArea.Title>
      <StackPanel>
        <DockPanel>
          <StackPanel HorizontalAlignment="Right" Margin="0 -5 0 0" DockPanel.Dock="Right" Orientation="Horizontal" Spacing="10">
            <Button Classes="function" Command="{Binding SendCommand}">
              <StackPanel Orientation="Horizontal" Spacing="15">
                <PathIcon Data="{StaticResource wallet_action_send}" />
                <TextBlock Text="Send" />
              </StackPanel>
            </Button>
            <Button Classes="function" Command="{Binding ReceiveCommand}">
              <StackPanel Orientation="Horizontal" Spacing="15">
                <PathIcon Data="{StaticResource wallet_action_receive}" />
                <TextBlock Text="Receive" />
              </StackPanel>
            </Button>
            <Button Classes="function">
              <Button.Flyout>
                <MenuFlyout Placement="Bottom">
                  <MenuItem Header="Wallet Info" Command="{Binding WalletInfoCommand}" />
                </MenuFlyout>
              </Button.Flyout>
              <PathIcon Data="{StaticResource more_regular}" Foreground="{DynamicResource TextForegroundColor}" />
            </Button>
          </StackPanel>
          <TextBlock TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" Text="{Binding WalletName, FallbackValue=My Wallet with a very long name}" />
        </DockPanel>
        <Separator DockPanel.Dock="Bottom" Margin="-200 13 -200 0" HorizontalAlignment="Stretch" />
      </StackPanel>

    </c:ContentArea.Title>
    <DockPanel VerticalAlignment="Top">

      <ScrollViewer Name="ScrollViewer"
                    DockPanel.Dock="Top"
                    Width="{Binding #HistoryTable.Bounds.Width}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                    ScrollViewer.VerticalScrollBarVisibility="Disabled">
        <ItemsRepeater Items="{Binding Tiles}"
                       DockPanel.Dock="Top"
                       Margin="0 0"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Top"
                       UseLayoutRounding="False">
          <ItemsRepeater.Styles>
            <Style Selector="ItemsRepeater > :is(Control)" x:DataType="tiles:TileViewModel">
              <Setter Property="(c:NonVirtualizingResponsiveLayout.ColumnSpan)"
                      Value="{Binding ColumnSpan}" />
              <Setter Property="(c:NonVirtualizingResponsiveLayout.RowSpan)" Value="{Binding RowSpan}" />
            </Style>
          </ItemsRepeater.Styles>
          <ItemsRepeater.ItemTemplate>
            <locator:ViewLocator />
          </ItemsRepeater.ItemTemplate>
          <ItemsRepeater.Layout>
            <c:NonVirtualizingResponsiveLayout ItemWidth="330"
                                               ItemHeight="150"
                                               WidthSource="{Binding #ScrollViewer.Bounds.Width}"
                                               AspectRatio="NaN"
                                               ColumnHints="3, 3, 3"
                                               WidthTriggers="300, 660, 990" />
          </ItemsRepeater.Layout>
        </ItemsRepeater>

      </ScrollViewer>
      <history:HistoryTable Name="HistoryTable" DataContext="{Binding History}" MaxWidth="1000"
                            HorizontalAlignment="Left" VerticalAlignment="Top" />
    </DockPanel>
  </c:ContentArea>
</UserControl>

<UserControl xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:controls="clr-namespace:WalletWasabi.Gui.Controls;assembly=WalletWasabi.Gui"
  xmlns:converters="clr-namespace:WalletWasabi.Gui.Converters;assembly=WalletWasabi.Gui"
  xmlns:i="clr-namespace:Avalonia.Xaml.Interactivity;assembly=Avalonia.Xaml.Interactivity"
  xmlns:dr="clr-namespace:WalletWasabi.Gui.Controls.DataRepeater;assembly=WalletWasabi.Gui"
  xmlns:behaviors="clr-namespace:WalletWasabi.Gui.Behaviors;assembly=WalletWasabi.Gui" x:Class="WalletWasabi.Gui.Controls.WalletExplorer.CoinListView">
  <UserControl.Resources>
    <converters:PrivacyLevelValueConverter x:Key="PrivacyLevelValueConverter" />
    <converters:CoinStatusStringConverter x:Key="CoinStatusStringConverter" />
    <converters:CoinStatusColorConverter x:Key="CoinStatusColorConverter" />
    <converters:CoinStatusBorderBrushConverter x:Key="CoinStatusBorderBrushConverter" />
    <converters:CoinStatusForegroundConverter x:Key="CoinStatusForegroundConverter" />
    <converters:CoinItemExpanderColorConverter x:Key="CoinItemExpanderColorConverter" />
    <converters:LurkingWifeModeStringConverter x:Key="LurkingWifeModeStringConverter" />
  </UserControl.Resources>
  <UserControl.Styles>
    <Style Selector="TextBlock">
      <Setter Property="VerticalAlignment" Value="Center" />
      <Setter Property="FontSize" Value="{DynamicResource FontSizeNormal}" />
    </Style>
    <Style Selector="TextBox">
      <Setter Property="FontSize" Value="{DynamicResource FontSizeNormal}" />
    </Style>
    <Style Selector="Grid.CoinItemGrid">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="Height" Value="24" />
    </Style>
    <Style Selector="Grid.CoinItemGrid > :is(Control)">
      <Setter Property="VerticalAlignment" Value="Center" />
    </Style>
  </UserControl.Styles>
  <i:Interaction.Behaviors>
    <behaviors:ClearPropertyOnLostFocusBehavior TargetProperty="{Binding SelectedCoin}" />
    <behaviors:CommandOnFirstVisible Command="{Binding InitList}" />
  </i:Interaction.Behaviors>
  <Grid>
    <Grid.Styles>
      <Style Selector="dr|DataRepeaterCellContent.InCoinJoin, dr|DataRepeaterCellContent.IsSelected">
        <Setter Property="Template">
          <ControlTemplate>
            <CheckBox Height="40" IsChecked="{TemplateBinding CellValue, Mode=TwoWay}" />
          </ControlTemplate>
        </Setter>
      </Style>
      <Style Selector="dr|DataRepeaterCellContent.AnonymitySet">
        <Setter Property="Template">
          <ControlTemplate>

            <Panel VerticalAlignment="Center" HorizontalAlignment="Center" Background="Transparent" DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CellValue, Mode=OneWay, Converter={StaticResource PrivacyLevelValueConverter}}" ToolTip.Tip="{Binding ToolTip}">
              <DrawingPresenter Drawing="{Binding Icon}" Height="16" Width="16" Margin="0 0 15 0" />
            </Panel>

          </ControlTemplate>
        </Setter>
      </Style>



    </Grid.Styles>

    <DockPanel LastChildFill="True">

      <StackPanel Margin="0 10 0 0" Spacing="10" DockPanel.Dock="Bottom" Orientation="Horizontal">
        <CheckBox IsThreeState="True" Margin="0" IsChecked="{Binding SelectPrivateCheckBoxState}" IsVisible="{Binding SelectAllPrivateVisible}" Command="{Binding SelectPrivateCheckBoxCommand}">
          <StackPanel Spacing="5" Orientation="Horizontal" ToolTip.Tip="Coins that have acquired the anonymity set target.">
            <TextBlock Text="Select" />
            <controls:Shields ShieldState="{Binding SelectAllPrivateShieldState}" />
            <TextBlock Text="Coins" />
          </StackPanel>
        </CheckBox>
        <CheckBox IsThreeState="True" IsChecked="{Binding SelectNonPrivateCheckBoxState}" IsVisible="{Binding SelectAllNonPrivateVisible}" Command="{Binding SelectNonPrivateCheckBoxCommand}">
          <StackPanel Spacing="5" Orientation="Horizontal" ToolTip.Tip="Coins that have not acquired the anonymity set target.">
            <TextBlock Text="Select" />
            <controls:Shields ShieldState="{Binding SelectAllNonPrivateShieldState}" />
            <TextBlock Text="Coins" />
          </StackPanel>
        </CheckBox>
        <CheckBox Content="Select All" IsThreeState="True" IsChecked="{Binding SelectAllCheckBoxState}" Command="{Binding SelectAllCheckBoxCommand}" />
        <StackPanel Spacing="10" Orientation="Horizontal" IsVisible="{Binding IsAnyCoinSelected}">
          <TextBlock Text="|" />
          <TextBlock Text="Selected Amount:" />
          <TextBlock Foreground="YellowGreen" Text="{Binding SelectedAmount, ConverterParameter=8, Converter={StaticResource LurkingWifeModeStringConverter}}" />
          <TextBlock Text="BTC" />
          <TextBlock Text="Merging unmixed coins with mixed ones undoes the mixes." Classes="warningMessage" IsVisible="{Binding LabelExposeCommonOwnershipWarning}" />
        </StackPanel>
      </StackPanel>

      <dr:DataRepeater DockPanel.Dock="Top" Items="{Binding Coins}" />
    </DockPanel>
  </Grid>
</UserControl>

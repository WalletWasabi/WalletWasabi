<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:controls="clr-namespace:WalletWasabi.Gui.Controls;assembly=WalletWasabi.Gui"
             xmlns:converters="clr-namespace:WalletWasabi.Gui.Converters;assembly=WalletWasabi.Gui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:i="clr-namespace:Avalonia.Xaml.Interactivity;assembly=Avalonia.Xaml.Interactivity"
             xmlns:behaviors="clr-namespace:WalletWasabi.Gui.Behaviors;assembly=WalletWasabi.Gui">
  <UserControl.Resources>
    <converters:PrivacyLevelValueConverter x:Key="PrivacyLevelValueConverter" />
    <converters:CoinStatusStringConverter x:Key="CoinStatusStringConverter" />
    <converters:CoinStatusColorConverter x:Key="CoinStatusColorConverter" />
    <converters:CoinStatusBorderBrushConverter x:Key="CoinStatusBorderBrushConverter" />
    <converters:CoinStatusForegroundConverter x:Key="CoinStatusForegroundConverter" />
    <converters:CoinItemExpanderColorConverter x:Key="CoinItemExpanderColorConverter" />
  </UserControl.Resources>
  <UserControl.Styles>
    <Style Selector="TextBlock">
      <Setter Property="VerticalAlignment" Value="Center" />
    </Style>
    <Style Selector="TextBox.Transaparent">
      <Setter Property="Background" Value="Transparent" />
    </Style>
  </UserControl.Styles>
  <i:Interaction.Behaviors>
    <behaviors:ClearPropertyOnLostFocusBehavior TargetProperty="{Binding SelectedCoin}" />
  </i:Interaction.Behaviors>
  <Grid IsSharedSizeScope="True">
    <DockPanel LastChildFill="True">
      <Grid Margin="30 0 0 0" DockPanel.Dock="Top">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="30" />
          <ColumnDefinition Width="30" />
          <ColumnDefinition SharedSizeGroup="A" Width="{Binding CoinJoinStatusWidth, Mode=OneWay}" />
          <ColumnDefinition Width="130" />
          <ColumnDefinition Width="100" />
          <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <TextBlock Text="" Width="0" />
        <TextBlock Text="" Grid.Column="1" />

        <controls:SortingArrow Grid.Column="2" Text="Status" Command="{Binding SortCommand}" SortDirection="{Binding StatusSortDirection} " />

        <controls:SortingArrow Grid.Column="3" Text="Amount (BTC)" Command="{Binding SortCommand}" SortDirection="{Binding AmountSortDirection}" />

        <controls:SortingArrow Grid.Column="4" Text="Privacy" Command="{Binding SortCommand}" SortDirection="{Binding PrivacySortDirection}" />

        <controls:SortingArrow Grid.Column="5" Text="History" Command="{Binding SortCommand}" SortDirection="{Binding HistorySortDirection}" />
      </Grid>
      <StackPanel Margin="0 10 0 0" Spacing="10" DockPanel.Dock="Bottom" Orientation="Horizontal">
        <CheckBox Content = "Select All" IsThreeState="True" IsChecked = "{Binding SelectAllCheckBoxState}" Command="{Binding SelectAllCheckBoxCommand}" />
        <CheckBox Content = "Select All Private" IsThreeState="True" IsChecked = "{Binding SelectPrivateCheckBoxState}" Command="{Binding SelectPrivateCheckBoxCommand}" ToolTip.Tip="Coins those acquired the strongest privacy shield." />
        <CheckBox Content = "Select All Non-Private" IsThreeState="True" IsChecked = "{Binding SelectNonPrivateCheckBoxState}" Command="{Binding SelectNonPrivateCheckBoxCommand}" ToolTip.Tip="Coins those do not have the strongest privacy shield." />
      </StackPanel>
      <ListBox Items="{Binding Coins}" VirtualizationMode="None" SelectedItem="{Binding Path=SelectedCoin, Mode=TwoWay}">
        <ListBox.ContextMenu>
          <ContextMenu>
            <MenuItem Header="Dequeue from CoinJoin" Command="{Binding DequeueCoin}">
              <MenuItem.Icon>
                <Path HorizontalAlignment="Left"
                      Data="M3.24,7.51c-0.146,0.142-0.146,0.381,0,0.523l5.199,5.193c0.234,0.238,0.633,0.064,0.633-0.262v-2.634c0.105-0.007,0.212-0.011,0.321-0.011c2.373,0,4.302,1.91,4.302,4.258c0,0.957-0.33,1.809-1.008,2.602c-0.259,0.307,0.084,0.762,0.451,0.572c2.336-1.195,3.73-3.408,3.73-5.924c0-3.741-3.103-6.783-6.916-6.783c-0.307,0-0.615,0.028-0.881,0.063V2.575c0-0.327-0.398-0.5-0.633-0.261L3.24,7.51 M4.027,7.771l4.301-4.3v2.073c0,0.232,0.21,0.409,0.441,0.366c0.298-0.056,0.746-0.123,1.184-0.123c3.402,0,6.172,2.709,6.172,6.041c0,1.695-0.718,3.24-1.979,4.352c0.193-0.51,0.293-1.045,0.293-1.602c0-2.76-2.266-5-5.046-5c-0.256,0-0.528,0.018-0.747,0.05C8.465,9.653,8.328,9.81,8.328,9.995v2.074L4.027,7.771z" Fill="#22B14C"
                      Height="16" Width="16"  Stretch="Fill" />
              </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Sign message" Command="{Binding SignMessage}">
              <MenuItem.Icon>
                <Path HorizontalAlignment="Left"
                      Data="F1M12,5C11.447,5 11,4.553 11,4 11,3.447 11.447,3 12,3 12.553,3 13,3.447 13,4 13,4.553 12.553,5 12,5 M15,4.5C15,2.566 13.433,1 11.5,1 10.106,1 8.913,1.82 8.35,3L8,3 8,2 7,2 6,3 6,2 5,2 4,3 4,2 3,2 1,4 1,5 2,6 8.35,6C8.913,7.18 10.106,8 11.5,8 13.433,8 15,6.434 15,4.5" Fill="#22B14C"
                      Height="8" Width="16"  Stretch="Fill" />
              </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Verify message" Command="{Binding VerifyMessage}">
              <MenuItem.Icon>
                <Path HorizontalAlignment="Left"
                      Data="F1M12,5C11.447,5 11,4.553 11,4 11,3.447 11.447,3 12,3 12.553,3 13,3.447 13,4 13,4.553 12.553,5 12,5 M15,4.5C15,2.566 13.433,1 11.5,1 10.106,1 8.913,1.82 8.35,3L8,3 8,2 7,2 6,3 6,2 5,2 4,3 4,2 3,2 1,4 1,5 2,6 8.35,6C8.913,7.18 10.106,8 11.5,8 13.433,8 15,6.434 15,4.5" Fill="#22B14C"
                      Height="8" Width="16"  Stretch="Fill" />
              </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Encrypt message" Command="{Binding EncryptMessage}">
              <MenuItem.Icon>
                <Path HorizontalAlignment="Left"
                      Data="F1M12,6L8,6 8,4C8,2.729 8.729,2 10,2 11.271,2 12,2.729 12,4z M13,6L13,4C13,2.178 11.822,1 10,1 8.178,1 7,2.178 7,4L7,6 6.949,6C6.973,6.165 7,6.329 7,6.5 7,6.669 6.987,6.836 6.964,7L14,7 14,13 7,13 7,14 15,14 15,6z M9,9C9,8.448 9.448,8 10,8 10.552,8 11,8.448 11,9 11,9.366 10.794,9.673 10.5,9.847L10.5,12 9.5,12 9.5,9.847C9.206,9.673,9,9.366,9,9 M5,6.5C5,7.328 4.329,8 3.5,8 2.671,8 2,7.328 2,6.5 2,5.672 2.671,5 3.5,5 4.329,5 5,5.672 5,6.5 M1,6.5C1,7.709,1.859,8.769,3,9L3,15 4,15 4,14 6,14 6,13 4,13 4,12 6,12 6,11 4,11 4,9C5.141,8.769 6,7.709 6,6.5 6,5.119 4.881,4 3.5,4 2.119,4 1,5.119 1,6.5" Fill="#22B14C"
                      Height="16" Width="16"  Stretch="Fill" />
              </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Decrypt message" Command="{Binding DecryptMessage}">
              <MenuItem.Icon>
                <Path HorizontalAlignment="Left"
                      Data="F1M12,6L8,6 8,4C8,2.729 8.729,2 10,2 11.271,2 12,2.729 12,4z M13,6L13,4C13,2.178 11.822,1 10,1 8.178,1 7,2.178 7,4L7,6 6.949,6C6.973,6.165 7,6.329 7,6.5 7,6.669 6.987,6.836 6.964,7L14,7 14,13 7,13 7,14 15,14 15,6z M9,9C9,8.448 9.448,8 10,8 10.552,8 11,8.448 11,9 11,9.366 10.794,9.673 10.5,9.847L10.5,12 9.5,12 9.5,9.847C9.206,9.673,9,9.366,9,9 M5,6.5C5,7.328 4.329,8 3.5,8 2.671,8 2,7.328 2,6.5 2,5.672 2.671,5 3.5,5 4.329,5 5,5.672 5,6.5 M1,6.5C1,7.709,1.859,8.769,3,9L3,15 4,15 4,14 6,14 6,13 4,13 4,12 6,12 6,11 4,11 4,9C5.141,8.769 6,7.709 6,6.5 6,5.119 4.881,4 3.5,4 2.119,4 1,5.119 1,6.5" Fill="#22B14C"
                      Height="16" Width="16"  Stretch="Fill" />
              </MenuItem.Icon>
            </MenuItem>
          </ContextMenu>
        </ListBox.ContextMenu>
        <ListBox.ItemTemplate>
          <DataTemplate>
            <Grid>
              <Expander Name="coinExpander" ExpandDirection="Down"  Classes="coloredExpander"  Background="{Binding ElementName=coinExpander, Path=IsExpanded, Converter={StaticResource CoinItemExpanderColorConverter}}">

                <StackPanel>
                  <Grid HorizontalAlignment="Left" ColumnDefinitions="150, *" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto" MaxWidth="800">
                    <TextBlock Text="Transaction Id:" Grid.Row="0" />
                    <controls:ExtendedTextBox Classes="selectableTextBlock Transaparent" Text="{Binding TransactionId}" Background="Transparent" Grid.Column="1" Grid.Row="0" />

                    <TextBlock Text="Output Index:" Grid.Row="1" />
                    <controls:ExtendedTextBox Classes="selectableTextBlock Transaparent" Text="{Binding OutputIndex}"  Grid.Column="1" Grid.Row="1" />

                    <TextBlock Text="Label:" Grid.Row="2" />
                    <controls:ExtendedTextBox Classes="selectableTextBlock Transaparent" Text="{Binding Label}"  Grid.Column="1" Grid.Row="2" />

                    <TextBlock Text="Address:" Grid.Row="3" />
                    <controls:ExtendedTextBox Classes="selectableTextBlock Transaparent" Text="{Binding Address}"  Grid.Column="1" Grid.Row="3" />

                    <TextBlock Text="Confirmations:" Grid.Row="4" />
                    <controls:ExtendedTextBox Classes="selectableTextBlock Transaparent" Text="{Binding Confirmations}"  Grid.Column="1" Grid.Row="4" />

                    <TextBlock Text="Anonymity Set:" Grid.Row="5" />
                    <controls:ExtendedTextBox Classes="selectableTextBlock Transaparent" Text="{Binding AnonymitySet}"  Grid.Column="1" Grid.Row="5" />
                  </Grid>
                </StackPanel>
              </Expander>

              <Grid Margin="30 0 0 0" VerticalAlignment="Top">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="30" />
                  <ColumnDefinition Width="30" />
                  <ColumnDefinition SharedSizeGroup="A" />
                  <ColumnDefinition Width="123" />
                  <ColumnDefinition Width="100" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <CheckBox HorizontalContentAlignment="Left" IsChecked="{Binding IsSelected}" Background="{DynamicResource ThemeBackgroundBrush}" />
                <Border Background="Transparent" IsVisible="{Binding Confirmed}" Grid.Column="1" ToolTip.Tip="Confirmed">
                  <Path HorizontalAlignment="Left" Data="F1 M 23.7501,33.25L 34.8334,44.3333L 52.2499,22.1668L 56.9999,26.9168L 34.8334,53.8333L 19.0001,38L 23.7501,33.25 Z" Fill="#22B14C" Height="16" Width="16"  Stretch="Fill" />
                </Border>

                <Border ToolTip.Tip="{Binding ToolTip}" Padding="1" Grid.Column="2" Background="{Binding Status, Converter={StaticResource CoinStatusColorConverter}}" BorderBrush="{Binding Status, Converter={StaticResource CoinStatusBorderBrushConverter}}" HorizontalAlignment="Left"  BorderThickness="1" CornerRadius="0,6,6,0">
                  <TextBlock Text="{Binding Status, Converter={StaticResource CoinStatusStringConverter}, Mode=OneWay}" Foreground="{Binding Status, Converter={StaticResource CoinStatusForegroundConverter}}" />
                </Border>
                <TextBlock Grid.Column="3" Text="{Binding AmountBtc}" />
                <Panel Grid.Column="4" VerticalAlignment="Center" HorizontalAlignment="Center" Background="Transparent"
                    DataContext="{Binding AnonymitySet, Converter={StaticResource PrivacyLevelValueConverter}}"
                    ToolTip.Tip="{Binding ToolTip}">
                  <DrawingPresenter Drawing="{Binding Icon}" Margin="0 0 25 0" />
                </Panel>
                <controls:ExtendedTextBox Classes="selectableTextBlock" Background="Transparent" Grid.Column="5" Text="{Binding History}" />
                <TextBlock Text="" Grid.Column="6" />
              </Grid>
            </Grid>
          </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox>
    </DockPanel>
  </Grid>
</UserControl>
